<div
  class="item-card mt-3 driver-license-card wide-card"
  *ngFor="let license of driver.doc.licenseData; let i = index"
  [style.z-index]="1000 + i"
>
  <div class="item-card-header radius-none top-header p-0 d-flex justify-content-between">
    <div class="data-panel d-flex justify-content-around align-items-left">
      <div class="label-container d-flex align-items-center">
        <span class="details-card-label" style="color: #919191;" appSelectionColor>Number</span>
        <span class="details-card-value" style="color: #919191;" appSelectionColor>{{
          license.number
        }}</span>
      </div>
    </div>
    <div class="action-container d-flex justify-content-around align-items-center">
      <app-truckassist-dropdown
        (actionEvent)="openAction($event)"
        [identificator]="license.id"
        [mainActions]="dropdownOptions.mainActions"
        [otherActions]="dropdownOptions.otherActions"
        [deleteAction]="dropdownOptions.deleteAction"
        [category]="'driver license'"
      ></app-truckassist-dropdown>
    </div>
  </div>

  <div class="item-card-header radius-none top-header p-0 d-flex justify-content-between">
    <div class="data-panel d-flex justify-content-around align-items-left">
      <div class="label-container d-flex align-items-center mr-3">
        <span class="details-card-label" style="color: #919191;" appSelectionColor
          >License class</span
        >
        <span class="details-card-value" style="color: #919191;" appSelectionColor>{{
          license.class?.value.replace('Class ', '')
        }}</span>
      </div>
    </div>
    <div
      class="action-container second-icon-wrapper d-flex justify-content-around align-items-center p-0"
    >
      <button
        class="custom-rounded-btn"
        [ngClass]="{
          'active-btn': attachmentsVisible[i],
          'empty-icon': !attachmentsVisible[i]
        }"
        *ngIf="driver.status && license.attachments?.length"
        (click)="attachmentsVisible[i] = !attachmentsVisible[i]"
      >
        <svg-icon
          class="empty-icon"
          src="assets/img/svgs/table/attach.svg"
          [svgStyle]="{ 'width.px': '19', 'height.px': '20' }"
        ></svg-icon>
      </button>
    </div>
  </div>

  <div class="item-card-header radius-none top-header p-0 d-flex justify-content-between">
    <div class="data-panel d-flex justify-content-around align-items-left">
      <div class="label-container d-flex align-items-center">
        <span class="details-card-label" style="color: #919191;" appSelectionColor>Issued</span>
        <span class="details-card-value" style="color: #919191;" appSelectionColor>{{
          license.startDate | date: 'shortDate'
        }}</span>
      </div>
    </div>
  </div>

  <div
    class="item-card-header state-hover-wrapper radius-none top-header p-0 d-flex justify-content-between"
  >
    <div class="data-panel d-flex justify-content-around align-items-left">
      <div class="label-container d-flex align-items-center">
        <span class="details-card-label mr-3" style="color: #919191;" appSelectionColor>{{
          license.state?.value
        }}</span>
        <span class="details-card-value">
          <svg-icon
            [src]="'assets/img/svgs/states/' + license.state?.value + '.svg'"
            [svgStyle]="{ 'width.px': '44', 'height.px': '19.09' }"
          ></svg-icon>
        </span>
      </div>
    </div>
  </div>

  <div class="item-card-header h-auto radius-none top-header p-0">
    <div class="flex-fill mb-3">
      <label class="m-0"
        ><strong class="font-16 cdl-data-title" style="color: #919191;" appSelectionColor
          >Endorsements</strong
        ></label
      >
      <label
        *ngIf="!license.endorsements || license.endorsements?.length === 0"
        class="no-mar no-value-label m-0"
        style="color: #919191;"
        appSelectionColor
        >NONE</label
      >
      <div *ngFor="let endo of license.endorsements" style="height: 24px;">
        <label
          *ngIf="endo.endorsementName.length >= 40"
          [appTaTooltip]="endo.endorsementName"
          position="bottom-right"
          class="col-form-label fw-400"
          style="color: #919191;"
          appSelectionColor
          >{{ endo.endorsementName | shorten: 40 }}</label
        >
        <label
          class="col-form-label fw-400"
          *ngIf="endo.endorsementName.length < 40"
          style="color: #919191;"
          appSelectionColor
          >{{ endo.endorsementName | shorten: 40 }}</label
        >
      </div>
    </div>
    <div class="flex-fill">
      <label class="m-0"
        ><strong class="font-16 cdl-data-title" style="color: #919191;" appSelectionColor
          >Restrictions</strong
        ></label
      >
      <label
        *ngIf="!license.restrictions || license.restrictions?.length === 0"
        class="no-mar no-value-label m-0"
        style="color: #919191;"
        appSelectionColor
        >NONE</label
      >
      <div *ngFor="let rest of license.restrictions" style="height: 24px;">
        <label
          *ngIf="rest.restrictionName.length >= 40"
          [appTaTooltip]="rest.restrictionName"
          position="bottom-right"
          class="col-form-label fw-400"
          style="color: #919191;"
          appSelectionColor
          >{{ rest.restrictionName | shorten: 40 }}</label
        >
        <label
          class="col-form-label fw-400"
          *ngIf="rest.restrictionName.length < 40"
          style="color: #919191;"
          appSelectionColor
          >{{ rest.restrictionName | shorten: 40 }}</label
        >
      </div>
    </div>
  </div>

  <div
    *ngIf="license.endDate"
    class="mt-3 truckassist-progress-container{{
      attachmentsVisible[i] ? ' attachment-visible' : ''
    }}"
  >
    <app-progress-expiration
      [startDate]="license.startDate | date: 'shortDate'"
      [expireDate]="license.endDate | date: 'shortDate'"
      [status]="driver.status"
    ></app-progress-expiration>
  </div>

  <app-card-preview
    [attachments]="license.attachments"
    [visible]="attachmentsVisible[i]"
  ></app-card-preview>
</div>
